<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>GameDev Survival Guide</title>
    <meta name="description" content="A concise guide on surviving in the video game industry, featuring how software engineers work across levels." />
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Orbitron:wght@400;600;700;900&display=swap');
      
      :root {
        /* Gaming color palette */
        --bg-primary: #0a0614;
        --bg-secondary: #1a0b2e;
        --bg-accent: #2b1055;
        
        /* Neon gaming colors */
        --neon-pink: #ff006e;
        --neon-blue: #3a86ff;
        --neon-cyan: #00f5ff;
        --neon-green: #00ff88;
        --neon-yellow: #ffbe0b;
        --neon-purple: #c77dff;
        --neon-orange: #fb5607;
        
        /* Text colors */
        --text-primary: #ffffff;
        --text-secondary: #e4c1ff;
        --text-muted: #9d79bc;
        
        /* UI elements */
        --border: rgba(255, 0, 110, 0.3);
        --border-hover: rgba(0, 245, 255, 0.6);
        
        /* Gradients */
        --gradient-pink: linear-gradient(135deg, #ff006e, #c77dff);
        --gradient-blue: linear-gradient(135deg, #3a86ff, #00f5ff);
        --gradient-green: linear-gradient(135deg, #00ff88, #00f5ff);
        --gradient-rainbow: linear-gradient(135deg, #ff006e, #ffbe0b, #00ff88, #00f5ff, #3a86ff, #c77dff);
        
        /* Effects */
        --shadow-neon-pink: 0 0 20px rgba(255, 0, 110, 0.5);
        --shadow-neon-blue: 0 0 20px rgba(58, 134, 255, 0.5);
        --shadow-neon-cyan: 0 0 20px rgba(0, 245, 255, 0.5);
        --shadow-lg: 0 20px 40px rgba(0,0,0,0.5);
        
        /* Sizing */
        --radius-sm: 8px;
        --radius-md: 12px;
        --radius-lg: 20px;
        
        /* Animation */
        --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
        --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
        --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html {
        font-size: 16px;
        scroll-behavior: smooth;
      }

      body {
        min-height: 100vh;
        font-family: 'Orbitron', monospace;
        background: var(--bg-primary);
        color: var(--text-primary);
        line-height: 1.6;
        position: relative;
        overflow-x: hidden;
      }

      /* Animated starfield background */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: 
          radial-gradient(2px 2px at 20% 30%, white, transparent),
          radial-gradient(2px 2px at 60% 70%, white, transparent),
          radial-gradient(1px 1px at 50% 50%, white, transparent),
          radial-gradient(1px 1px at 80% 10%, white, transparent),
          radial-gradient(2px 2px at 90% 60%, white, transparent);
        background-size: 200% 200%;
        background-repeat: repeat;
        animation: stars 120s linear infinite;
        opacity: 0.3;
        pointer-events: none;
        z-index: 0;
      }

      /* Grid overlay effect */
      body::after {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: 
          linear-gradient(rgba(0, 245, 255, 0.03) 1px, transparent 1px),
          linear-gradient(90deg, rgba(0, 245, 255, 0.03) 1px, transparent 1px);
        background-size: 50px 50px;
        pointer-events: none;
        z-index: 0;
        animation: grid 20s linear infinite;
      }

      @keyframes stars {
        from { transform: translateY(0); }
        to { transform: translateY(-100%); }
      }

      @keyframes grid {
        from { transform: translate(0, 0); }
        to { transform: translate(50px, 50px); }
      }




      .container {
        position: relative;
        z-index: 1;
        max-width: 1280px;
        margin: 0 auto;
        padding: 2rem 1.5rem 4rem;
      }

      /* Header with retro gaming style */
      .hero {
        background: linear-gradient(135deg, rgba(255, 0, 110, 0.1), rgba(0, 245, 255, 0.1)),
                    var(--bg-secondary);
        border: 2px solid var(--neon-pink);
        border-radius: var(--radius-lg);
        padding: 3rem 2rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
        box-shadow: 
          inset 0 0 50px rgba(255, 0, 110, 0.1),
          0 0 30px rgba(255, 0, 110, 0.3);
      }

      .hero::before {
        content: "üéÆ";
        position: absolute;
        top: 20px;
        right: 20px;
        font-size: 3rem;
        opacity: 0.3;
      }

      .hero::after {
        content: "üïπÔ∏è";
        position: absolute;
        bottom: 20px;
        left: 20px;
        font-size: 3rem;
        opacity: 0.3;
      }

      .hero h1 {
        font-family: 'Press Start 2P', cursive;
        font-size: 2rem;
        background: var(--gradient-rainbow);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 1rem;
        text-transform: uppercase;
        letter-spacing: 2px;
        position: relative;
      }

      @media (min-width: 768px) {
        .hero h1 {
          font-size: 2.5rem;
        }
      }

      .hero p {
        color: var(--text-secondary);
        font-size: 1.125rem;
        max-width: 65ch;
        position: relative;
        font-weight: 400;
      }

      /* Section */
      section {
        margin-top: 2rem;
      }

      section h2 {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: var(--neon-cyan);
        text-shadow: 0 0 10px var(--neon-cyan);
      }

      .lead {
        color: var(--text-secondary);
        margin-bottom: 1.5rem;
        font-weight: 400;
      }

      /* Panel with gaming aesthetic */
      .panel {
        background: linear-gradient(135deg, rgba(43, 16, 85, 0.8), rgba(26, 11, 46, 0.9));
        backdrop-filter: blur(10px);
        border: 2px solid;
        border-image: var(--gradient-blue) 1;
        border-radius: var(--radius-md);
        box-shadow: 
          inset 0 0 30px rgba(58, 134, 255, 0.1),
          0 0 40px rgba(58, 134, 255, 0.2);
        overflow: visible;
        transition: all var(--transition-base);
        position: relative;
      }

      .panel:hover {
        box-shadow: 
          inset 0 0 40px rgba(58, 134, 255, 0.2),
          0 0 60px rgba(58, 134, 255, 0.3);
        transform: translateY(-2px);
      }

      /* Matrix Layout */
      .matrix-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }

      @media (min-width: 1280px) {
        .matrix-container {
          grid-template-columns: 1fr 420px;
        }
      }

      /* Toolbar */
      .toolbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem 1.25rem;
        border-bottom: 2px solid rgba(0, 245, 255, 0.3);
        background: linear-gradient(90deg, rgba(255, 0, 110, 0.1), rgba(0, 245, 255, 0.1));
      }

      .toolbar-title {
        font-weight: 700;
        color: var(--neon-yellow);
        text-shadow: 0 0 10px var(--neon-yellow);
        font-size: 1.125rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      /* Table */
      .table-wrap {
        overflow: visible;
        padding: 0.5rem;
      }

      .matrix {
        width: 100%;
        border-collapse: separate;
        border-spacing: 4px;
      }

      .matrix th,
      .matrix td {
        padding: 0;
        text-align: left;
        vertical-align: top;
        background: rgba(26, 11, 46, 0.6);
        border: 1px solid rgba(0, 245, 255, 0.2);
        position: relative;
      }

      .matrix thead th {
        background: linear-gradient(135deg, rgba(255, 0, 110, 0.2), rgba(58, 134, 255, 0.2));
        font-weight: 700;
        font-size: 0.875rem;
        text-shadow: 0 0 5px currentColor;
        color: var(--neon-cyan);
        padding: 1rem;
        white-space: nowrap;
      }

      .matrix tbody th {
        background: linear-gradient(90deg, rgba(199, 125, 255, 0.2), rgba(0, 245, 255, 0.1));
        font-weight: 600;
        min-width: 180px;
      }

      /* Topic icons and descriptions */
      .topic-btn {
        width: 100%;
        text-align: left;
        background: transparent;
        color: var(--text-primary);
        padding: 1rem;
        border: none;
        cursor: pointer;
        font: inherit;
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
        transition: all var(--transition-fast);
        position: relative;
        overflow: hidden;
      }

      .topic-btn:hover {
        background: rgba(255, 0, 110, 0.1);
        text-shadow: 0 0 10px var(--neon-pink);
      }

      .topic-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 0, 110, 0.3), transparent);
        transition: left 0.5s;
      }

      .topic-btn:hover::before {
        left: 100%;
      }

      .topic-icon {
        font-size: 1.5rem;
        margin-bottom: 0.25rem;
      }

      .topic-name {
        font-weight: 700;
        color: var(--neon-green);
        text-shadow: 0 0 5px var(--neon-green);
        font-size: 0.9rem;
      }

      .topic-desc {
        font-size: 0.75rem;
        color: var(--text-muted);
        font-weight: 400;
      }

      /* Cell Button */
      .cell-btn {
        width: 100%;
        text-align: left;
        background: rgba(26, 11, 46, 0.4);
        color: var(--text-primary);
        padding: 0.75rem;
        border: none;
        cursor: pointer;
        font: inherit;
        display: block;
        transition: all var(--transition-fast);
        position: relative;
        overflow: hidden;
        font-size: 0.8rem;
        min-width: 140px;
        word-wrap: break-word;
      }

      .cell-btn:hover {
        background: linear-gradient(135deg, rgba(255, 0, 110, 0.2), rgba(0, 245, 255, 0.2));
        transform: scale(1.02);
        z-index: 2;
        box-shadow: 0 0 20px rgba(0, 245, 255, 0.4);
      }

      .cell-btn.has-content {
        color: var(--neon-yellow);
        font-weight: 600;
        background: linear-gradient(135deg, rgba(255, 190, 11, 0.1), rgba(0, 255, 136, 0.1));
        border: 1px solid rgba(255, 190, 11, 0.3);
      }

      .cell-btn.placeholder {
        color: var(--text-muted);
        font-style: italic;
        border: 1px dashed rgba(157, 121, 188, 0.3);
      }

      .cell-btn.placeholder::before {
        content: "‚ûï ";
        color: var(--neon-green);
      }

      /* Selected states */
      .matrix tbody tr.selected {
        background: linear-gradient(90deg, rgba(255, 0, 110, 0.15), transparent);
      }

      .matrix td.selected .cell-btn {
        background: linear-gradient(135deg, rgba(255, 0, 110, 0.3), rgba(0, 245, 255, 0.3));
        box-shadow: 
          inset 0 0 0 2px var(--neon-pink),
          0 0 30px rgba(255, 0, 110, 0.5);
      }

      /* Detail Panel */
      .detail-panel {
        animation: slideIn var(--transition-base) ease-out;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .detail-content {
        padding: 1.5rem;
        min-height: 200px;
      }

      .detail-empty {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 200px;
        color: var(--text-muted);
        font-style: italic;
        text-align: center;
        padding: 2rem;
      }

      .detail-empty::before {
        content: "üëæ ";
        font-size: 2rem;
        margin-right: 0.5rem;
      }

      .detail-header {
        font-size: 1.125rem;
        font-weight: 700;
        margin-bottom: 1rem;
        color: var(--neon-cyan);
        text-shadow: 0 0 10px var(--neon-cyan);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .detail-header::before {
        content: "üìä";
      }

      .level-list {
        list-style: none;
        padding: 0;
      }

      .level-item {
        padding: 1rem;
        margin-bottom: 0.5rem;
        background: linear-gradient(135deg, rgba(58, 134, 255, 0.1), rgba(199, 125, 255, 0.1));
        border: 1px solid rgba(58, 134, 255, 0.3);
        border-radius: var(--radius-sm);
        animation: fadeIn var(--transition-base) ease-out;
        transition: all var(--transition-fast);
      }

      .level-item:hover {
        transform: translateX(5px);
        box-shadow: 0 0 20px rgba(58, 134, 255, 0.3);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateX(-10px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .level-name {
        font-weight: 700;
        color: var(--neon-green);
        display: block;
        margin-bottom: 0.25rem;
        text-shadow: 0 0 5px var(--neon-green);
        font-size: 0.9rem;
      }

      .level-name::before {
        content: "üéØ ";
      }

      .level-description {
        color: var(--text-secondary);
        font-size: 0.875rem;
      }

      /* Tales section */
      .tales-content {
        animation: fadeIn var(--transition-base) ease-out;
      }

      .tales-content .detail-header::before {
        content: "üìù";
      }

      /* Textarea styling */
      textarea {
        width: 100%;
        padding: 0.75rem;
        background: rgba(26, 11, 46, 0.6);
        border: 2px solid rgba(0, 245, 255, 0.3);
        border-radius: var(--radius-sm);
        color: var(--text-primary);
        font-family: 'Orbitron', monospace;
        font-size: 0.875rem;
        resize: vertical;
        transition: all var(--transition-fast);
      }

      textarea:focus {
        outline: none;
        border-color: var(--neon-cyan);
        box-shadow: 0 0 20px rgba(0, 245, 255, 0.3);
        background: rgba(26, 11, 46, 0.8);
      }

      textarea::placeholder {
        color: var(--text-muted);
        font-style: italic;
      }

      label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: var(--neon-yellow);
        text-shadow: 0 0 5px var(--neon-yellow);
        font-size: 0.9rem;
      }

      .input-group {
        margin-bottom: 1.25rem;
      }

      .tales-prompts {
        background: linear-gradient(135deg, rgba(255, 0, 110, 0.1), rgba(0, 245, 255, 0.1));
        border: 1px solid rgba(255, 0, 110, 0.3);
        border-radius: var(--radius-sm);
        padding: 1rem;
        margin-top: 1rem;
      }

      .tales-prompts h4 {
        font-size: 0.875rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: var(--neon-pink);
        text-shadow: 0 0 5px var(--neon-pink);
      }

      .tales-prompts h4::before {
        content: "üí° ";
      }

      .tales-prompts ul {
        list-style: none;
        padding: 0;
      }

      .tales-prompts li {
        padding: 0.25rem 0;
        color: var(--text-secondary);
        font-size: 0.875rem;
      }

      .tales-prompts li::before {
        content: "‚ñ∏ ";
        color: var(--neon-green);
        font-weight: bold;
      }

      /* Mobile Detail Panel */
      @media (max-width: 1023px) {
        .detail-panel {
          margin-top: 1.5rem;
        }
        
        .matrix thead th {
          font-size: 0.75rem;
          padding: 0.75rem;
        }
        
        .topic-btn {
          padding: 0.75rem;
        }
        
        .topic-icon {
          font-size: 1.25rem;
        }
        
        .topic-name {
          font-size: 0.8rem;
        }
        
        .topic-desc {
          font-size: 0.7rem;
        }
      }

      /* Footer */
      footer {
        text-align: center;
        padding: 2rem 0;
        color: var(--text-muted);
        font-size: 0.875rem;
      }

      footer::before {
        content: "üöÄ ";
      }

      footer a {
        color: var(--neon-purple);
        text-decoration: none;
        transition: all var(--transition-fast);
      }

      footer a:hover {
        color: var(--neon-pink);
        text-shadow: 0 0 10px currentColor;
      }

      /* Accessibility */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }

      /* Loading animation */
      @keyframes arcade-blink {
        0%, 49% { opacity: 1; }
        50%, 100% { opacity: 0; }
      }

      .blink {
        animation: arcade-blink 1s infinite;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="hero">
        <h1>GameDev Survival Guide</h1>
        <p>Level up your career in the video game industry! Master the skills, unlock achievements, and become a legendary game developer. üéÆ‚ú®</p>
      </header>

      <section aria-labelledby="matrix-heading">
        <h2 id="matrix-heading">üéØ Engineer Evolution Matrix</h2>
        <p class="lead">Track your progression through the ranks! Click cells to unlock knowledge and share your epic dev stories.</p>

        <div class="matrix-container">
          <!-- Main Matrix Panel -->
          <div class="panel" id="matrix-panel">
            <div class="toolbar">
              <div class="toolbar-title">
                <span>‚ö°</span>
                <span>Skills & Expectations</span>
              </div>
            </div>
            <div class="table-wrap">
              <table class="matrix" role="table" aria-label="Software engineering expectations by level and topic">
                <thead>
                  <tr id="matrix-header">
                    <!-- Generated by JavaScript -->
                  </tr>
                </thead>
                <tbody id="matrix-body">
                  <!-- Generated by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Detail Panel -->
          <aside class="panel detail-panel" id="detail-panel" aria-live="polite">
            <div class="toolbar">
              <div class="toolbar-title" id="detail-title">
                <span>üéØ</span>
                <span>Select Your Quest</span>
              </div>
            </div>
            <div class="detail-content" id="detail-content">
              <div class="detail-empty">
                Choose your path! Click on a skill category to see the full progression tree, or select a specific cell to unlock detailed requirements and share your war stories.
              </div>
            </div>
          </aside>
        </div>
      </section>

      <footer>
        <p>GameDev Survival Guide | Power Level: <span class="blink">‚àû</span> | <a href="#" onclick="resetData(); return false;">Reset Save Game</a></p>
      </footer>
    </div>

    <script>
      // Data structure for the matrix with gaming-themed content
      const matrixData = {
        levels: [
          'Junior Engineer',
          'Software Engineer', 
          'Senior Engineer',
          'Principal Engineer',
          'Distinguished Engineer'
        ],
        topics: [
          {
            id: 'Communication',
            icon: 'üí¨',
            name: 'Communication',
            description: 'Team sync & player feedback'
          },
          {
            id: 'WaysOfWorking',
            icon: '‚öôÔ∏è',
            name: 'Ways of Working',
            description: 'Dev processes & workflows'
          },
          {
            id: 'CraftExpertise',
            icon: 'üõ†Ô∏è',
            name: 'Craft Expertise',
            description: 'Technical mastery & skills'
          },
          {
            id: 'Business',
            icon: 'üìà',
            name: 'Business Impact',
            description: 'Studio goals & KPIs'
          },
          {
            id: 'Mentorship',
            icon: 'üßô',
            name: 'Mentorship',
            description: 'Leveling up teammates'
          },
          {
            id: 'Collaboration',
            icon: 'ü§ù',
            name: 'Collaboration',
            description: 'Cross-team quests'
          }
        ],
        expectations: {
          'Communication': {
            'Junior Engineer': {
              summary: 'Daily standups, PR comments, asks for help when stuck',
              details: 'Participates actively in daily standups, writes clear PR descriptions, communicates blockers early.',
              tales: ''
            },
            'Software Engineer': {
              summary: '',
              details: '',
              tales: ''
            },
            'Senior Engineer': {
              summary: '',
              details: '',
              tales: ''
            },
            'Principal Engineer': {
              summary: '',
              details: '',
              tales: ''
            },
            'Distinguished Engineer': {
              summary: '',
              details: '',
              tales: ''
            }
          },
          'WaysOfWorking': {
            'Junior Engineer': { summary: '', details: '', tales: '' },
            'Software Engineer': { summary: '', details: '', tales: '' },
            'Senior Engineer': { summary: '', details: '', tales: '' },
            'Principal Engineer': { summary: '', details: '', tales: '' },
            'Distinguished Engineer': { summary: '', details: '', tales: '' }
          },
          'CraftExpertise': {
            'Junior Engineer': { summary: '', details: '', tales: '' },
            'Software Engineer': { summary: '', details: '', tales: '' },
            'Senior Engineer': { summary: '', details: '', tales: '' },
            'Principal Engineer': { summary: '', details: '', tales: '' },
            'Distinguished Engineer': { summary: '', details: '', tales: '' }
          },
          'Business': {
            'Junior Engineer': { summary: '', details: '', tales: '' },
            'Software Engineer': { summary: '', details: '', tales: '' },
            'Senior Engineer': { summary: '', details: '', tales: '' },
            'Principal Engineer': { summary: '', details: '', tales: '' },
            'Distinguished Engineer': { summary: '', details: '', tales: '' }
          },
          'Mentorship': {
            'Junior Engineer': { summary: '', details: '', tales: '' },
            'Software Engineer': { summary: '', details: '', tales: '' },
            'Senior Engineer': { summary: '', details: '', tales: '' },
            'Principal Engineer': { summary: '', details: '', tales: '' },
            'Distinguished Engineer': { summary: '', details: '', tales: '' }
          },
          'Collaboration': {
            'Junior Engineer': { summary: '', details: '', tales: '' },
            'Software Engineer': { summary: '', details: '', tales: '' },
            'Senior Engineer': { summary: '', details: '', tales: '' },
            'Principal Engineer': { summary: '', details: '', tales: '' },
            'Distinguished Engineer': { summary: '', details: '', tales: '' }
          }
        }
      };

      // State management
      let currentSelection = {
        type: null, // 'row' or 'cell'
        topic: null,
        level: null
      };

      // Initialize the application
      function init() {
        loadData();
        renderMatrix();
        setupEventListeners();
        checkMobileLayout();
      }

      // Load data from localStorage
      function loadData() {
        const saved = localStorage.getItem('gamedevMatrix');
        if (saved) {
          try {
            const parsed = JSON.parse(saved);
            // Merge saved expectations with current structure
            if (parsed.expectations) {
              Object.keys(parsed.expectations).forEach(topic => {
                if (matrixData.expectations[topic]) {
                  Object.keys(parsed.expectations[topic]).forEach(level => {
                    if (matrixData.expectations[topic][level]) {
                      matrixData.expectations[topic][level] = parsed.expectations[topic][level];
                    }
                  });
                }
              });
            }
          } catch (e) {
            console.error('Failed to load saved data:', e);
          }
        }
      }

      // Save data to localStorage
      function saveData() {
        try {
          localStorage.setItem('gamedevMatrix', JSON.stringify({
            expectations: matrixData.expectations
          }));
        } catch (e) {
          console.error('Failed to save data:', e);
        }
      }

      // Render the matrix table
      function renderMatrix() {
        const header = document.getElementById('matrix-header');
        const body = document.getElementById('matrix-body');

        // Render header with level icons
        header.innerHTML = `
          <th scope="col">Skill Tree</th>
          ${matrixData.levels.map((level, index) => {
            const levelIcons = ['üë∂', 'üí™', '‚≠ê', 'üëë', 'üèÜ'];
            return `<th scope="col">${levelIcons[index]} ${level}</th>`;
          }).join('')}
        `;

        // Render body with topic details
        body.innerHTML = matrixData.topics.map(topic => `
          <tr>
            <th scope="row">
              <button type="button" class="topic-btn" onclick="selectRow('${topic.id}')">
                <span class="topic-icon">${topic.icon}</span>
                <span class="topic-name">${topic.name}</span>
                <span class="topic-desc">${topic.description}</span>
              </button>
            </th>
            ${matrixData.levels.map(level => {
              const data = matrixData.expectations[topic.id][level];
              const hasContent = data.summary || data.details;
              const buttonClass = hasContent ? 'cell-btn has-content' : 'cell-btn placeholder';
              const buttonText = data.summary || `Click to add`;
              
              return `
                <td>
                  <button type="button" class="${buttonClass}" 
                          onclick="selectCell('${topic.id}', '${level}')"
                          data-topic="${topic.id}"
                          data-level="${level}">
                    ${buttonText}
                  </button>
                </td>
              `;
            }).join('')}
          </tr>
        `).join('');
      }

      // Select a row (topic overview)
      function selectRow(topicId) {
        const topic = matrixData.topics.find(t => t.id === topicId);
        
        // Update selection state
        currentSelection = {
          type: 'row',
          topic: topicId,
          level: null
        };

        // Update visual selection
        updateSelection();

        // Update detail panel
        const detailTitle = document.getElementById('detail-title');
        const detailContent = document.getElementById('detail-content');

        detailTitle.innerHTML = `
          <span>${topic.icon}</span>
          <span>${topic.name} Progression</span>
        `;

        const levelItems = matrixData.levels.map((level, index) => {
          const levelIcons = ['üë∂', 'üí™', '‚≠ê', 'üëë', 'üèÜ'];
          const data = matrixData.expectations[topicId][level];
          const text = data.summary || data.details || 'Awaiting definition...';
          
          return `
            <li class="level-item">
              <span class="level-name">${levelIcons[index]} ${level}</span>
              <span class="level-description">${text}</span>
            </li>
          `;
        }).join('');

        detailContent.innerHTML = `
          <div class="detail-header">Level Progression Path</div>
          <ul class="level-list">
            ${levelItems}
          </ul>
        `;

        // Scroll to detail on mobile
        if (window.innerWidth < 1024) {
          document.getElementById('detail-panel').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
      }

      // Select a cell
      function selectCell(topicId, level) {
        const topic = matrixData.topics.find(t => t.id === topicId);
        
        // Update selection state
        currentSelection = {
          type: 'cell',
          topic: topicId,
          level: level
        };

        // Update visual selection
        updateSelection();

        // Update detail panel
        const detailTitle = document.getElementById('detail-title');
        const detailContent = document.getElementById('detail-content');
        const data = matrixData.expectations[topicId][level];

        const levelIndex = matrixData.levels.indexOf(level);
        const levelIcons = ['üë∂', 'üí™', '‚≠ê', 'üëë', 'üèÜ'];

        detailTitle.innerHTML = `
          <span>${topic.icon}</span>
          <span>${topic.name}</span>
          <span style="color: var(--neon-green);">‚Ä¢</span>
          <span>${levelIcons[levelIndex]} ${level}</span>
        `;

        detailContent.innerHTML = `
          <div class="tales-content">
            <div class="detail-header">Quest Details & War Stories</div>
            
            <div class="input-group">
              <label for="summary-input">
                ‚ö° Quick Summary
              </label>
              <textarea id="summary-input" 
                       placeholder="Core expectations in a nutshell..."
                       onchange="updateCellData('${topicId}', '${level}', 'summary', this.value)"
                       rows="3">${data.summary || ''}</textarea>
            </div>

            <div class="input-group">
              <label for="details-input">
                üìã Detailed Requirements
              </label>
              <textarea id="details-input" 
                       placeholder="Specific skills, behaviors, and deliverables expected..."
                       onchange="updateCellData('${topicId}', '${level}', 'details', this.value)"
                       rows="5">${data.details || ''}</textarea>
            </div>

            <div class="input-group">
              <label for="tales-input">
                üéÆ Tales from the Crypt
              </label>
              <textarea id="tales-input" 
                       placeholder="Share your epic fails, legendary wins, and lessons learned from the trenches..."
                       onchange="updateCellData('${topicId}', '${level}', 'tales', this.value)"
                       rows="6">${data.tales || ''}</textarea>
            </div>

            <div class="tales-prompts">
              <h4>Story Prompts</h4>
              <ul>
                <li>The bug that taught you humility</li>
                <li>That crunch time miracle (or disaster)</li>
                <li>When the players broke everything</li>
                <li>The feature that shipped vs. what was designed</li>
                <li>Your "it works on my machine" moment</li>
              </ul>
            </div>
          </div>
        `;

        // Scroll to detail on mobile
        if (window.innerWidth < 1024) {
          document.getElementById('detail-panel').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
      }

      // Update visual selection in the table
      function updateSelection() {
        // Clear all selections
        document.querySelectorAll('.matrix tbody tr').forEach(tr => tr.classList.remove('selected'));
        document.querySelectorAll('.matrix td').forEach(td => td.classList.remove('selected'));

        if (currentSelection.type === 'row') {
          // Highlight the row
          const rows = document.querySelectorAll('.matrix tbody tr');
          const topicIndex = matrixData.topics.findIndex(t => t.id === currentSelection.topic);
          if (topicIndex >= 0 && rows[topicIndex]) {
            rows[topicIndex].classList.add('selected');
          }
        } else if (currentSelection.type === 'cell') {
          // Highlight the specific cell
          const button = document.querySelector(
            `button[data-topic="${currentSelection.topic}"][data-level="${currentSelection.level}"]`
          );
          if (button) {
            button.closest('td').classList.add('selected');
          }
        }
      }

      // Update cell data
      function updateCellData(topicId, level, field, value) {
        matrixData.expectations[topicId][level][field] = value;
        saveData();
        
        // Update the cell button if summary changed
        if (field === 'summary') {
          const button = document.querySelector(
            `button[data-topic="${topicId}"][data-level="${level}"]`
          );
          if (button) {
            button.textContent = value || 'Click to add';
            button.className = value ? 'cell-btn has-content' : 'cell-btn placeholder';
          }
        }
      }

      // Reset data to defaults
      function resetData() {
        if (confirm('‚ö†Ô∏è This will wipe your save game! All your data will be reset to factory defaults. Continue?')) {
          localStorage.removeItem('gamedevMatrix');
          location.reload();
        }
      }

      // Check for mobile layout
      function checkMobileLayout() {
        const detailPanel = document.getElementById('detail-panel');
        
        if (window.innerWidth < 1024) {
          detailPanel.setAttribute('aria-label', 'Details (shown below matrix on mobile)');
        } else {
          detailPanel.setAttribute('aria-label', 'Details panel');
        }
      }

      // Setup event listeners
      function setupEventListeners() {
        // Window resize
        window.addEventListener('resize', checkMobileLayout);

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            currentSelection = { type: null, topic: null, level: null };
            updateSelection();
            document.getElementById('detail-content').innerHTML = `
              <div class="detail-empty">
                Choose your path! Click on a skill category to see the full progression tree, or select a specific cell to unlock detailed requirements and share your war stories.
              </div>
            `;
            document.getElementById('detail-title').innerHTML = `
              <span>üéØ</span>
              <span>Select Your Quest</span>
            `;
          }
        });
      }

      // Initialize on load
      document.addEventListener('DOMContentLoaded', init);
    </script>
  </body>
</html>